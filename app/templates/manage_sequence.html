{% extends 'base.html' %}

{% block title %}Manage Sequence: {{ sequence.name }}{% endblock %}

{% block content %}
    <div class="page-header">
        <div>
            <h1>{{ sequence.name }}</h1>
            <p style="margin: 0; color: #555;">
                <strong>List:</strong> {{ sequence.list_name }} | 
                <strong>Status:</strong> <span class="status-badge status-{{ sequence.status|lower }}">{{ sequence.status }}</span> |
                <strong>Sending Via:</strong> {{ sending_config_details }}
                </p>
        </div>
        <div style="display: flex; gap: 1rem;">
            <a href="{{ url_for('sequence.add_sequence_step_route', sequence_id=sequence.id) }}" class="btn btn-primary"><i class="fas fa-plus"></i> Add New Step</a>
            <a href="{{ url_for('sequence.list_sequences') }}" class="btn btn-secondary">Back to Sequences</a>
        </div>
    </div>

    <h2>Sequence Steps</h2>
    
    {% if not steps %}
        <div class="card" style="text-align: center;">
            <h2 style="color: #95a5a6; font-weight: 300;">This sequence has no steps.</h2>
            <p>Get started by adding one.</p>
        </div>
    {% else %}
        {% for step in steps %}
        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: top;">
                <div>
                    <h3 style="margin-top: 0;">Step {{ step.step_number }} <span style="font-weight: 400; color: #7f8c8d;">({{ step.type }})</span></h3>
                    <p><strong>Campaign:</strong> {{ step.campaign_name }}</p>
                    <p><strong>Scheduled Time:</strong> {{ step.schedule_time.strftime('%Y-%m-%d %H:%M') if step.schedule_time else 'N/A' }}</p>
                    <p><strong>Status:</strong> <span class="status-badge status-{{ step.status|lower }}">{{ step.status }}</span></p>
                </div>
                <div style="display: flex; gap: 0.5rem; align-items: flex-start;">
                    <a href="{{ url_for('sequence.edit_sequence_step_route', step_id=step.id) }}" class="btn btn-secondary"><i class="fas fa-edit"></i> Edit</a>
                   <form method="POST" action="{{ url_for('sequence.delete_sequence_step_route', step_id=step.id) }}" onsubmit="return confirm('Are you sure you want to delete this step?');">
    <button type="submit" class="btn btn-danger">
        <i class="fas fa-trash"></i> Delete
    </button>
</form>
                </div>
            </div>
        </div>
        {% endfor %}
    {% endif %}

{% endblock %}