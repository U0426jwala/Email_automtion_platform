{% extends 'base.html' %}

{% block title %}
    View Contacts - {{ list_details.list_name if list_details else 'List' }}
{% endblock %}

{% block head_extra %}
<style>
    /* Re-using styles from upload_contacts.html for consistency */
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
        border-bottom: 1px solid #dee2e6;
        padding-bottom: 1rem;
    }
    .page-header h1 { font-size: 2rem; font-weight: 500; color: #2c3e50; margin: 0; }
    .page-header p { color: #7f8c8d; margin-top: 0.5rem; }
    .btn {
        border: none; padding: 0.75rem 1.5rem; border-radius: 5px;
        font-size: 1rem; font-weight: 500; cursor: pointer; transition: all 0.3s ease;
        text-decoration: none; display: inline-flex; align-items: center;
    }
    .btn-primary { background-color: #3498db; color: white; }
    .btn-primary:hover { background-color: #2980b9; }
    .btn-danger { background-color: #e74c3c; color: white; padding: 0.4rem 0.8rem; font-size: 0.8rem; }
    .btn-danger:hover { background-color: #c0392b; }
    .btn i { margin-right: 0.5rem; }

    .breadcrumb { margin-bottom: 1.5rem; }
    .breadcrumb a { color: #3498db; text-decoration: none; }
    .breadcrumb a:hover { text-decoration: underline; }
    .breadcrumb span { color: #7f8c8d; }

    /* Table Styles */
    .table-container {
        background: #ffffff; border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        overflow: hidden; border: 1px solid #e9ecef;
    }
    table { width: 100%; border-collapse: collapse; text-align: left; }
    th, td { padding: 1rem; border-bottom: 1px solid #e9ecef; }
    thead { background-color: #f8f9fa; }
    th { font-weight: 500; color: #495057; font-size: 0.8rem; text-transform: uppercase; }
    .empty-row { text-align: center; color: #7f8c8d; padding: 2rem; }
    .actions-cell { text-align: right; }

    /* Flash Messages */
    .flash-message { padding: 1rem; margin-bottom: 1rem; border-radius: 5px; border: 1px solid transparent; }
    .flash-success { background-color: #d4edda; color: #155724; border-color: #c3e6cb; }
    .flash-error { background-color: #f8d7da; color: #721c24; border-color: #f5c6cb; }
</style>
{% endblock %}

{% block content %}
<div class="breadcrumb">
    <a href="{{ url_for('contact.lists') }}">Contact Lists</a> / <span>{{ list_details.list_name if list_details else 'View Contacts' }}</span>
</div>

<div class="page-header">
    <div>
        <h1>{{ list_details.list_name if list_details else 'Contacts' }}</h1>
        <p>View, add, or remove contacts from this list.</p>
    </div>
    <a href="{{ url_for('contact.add_contact', list_id=list_id) }}" class="btn btn-primary">
        <i class="fas fa-plus-circle"></i>Add New Contact
    </a>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div>
            {% for category, message in messages %}
                <div class="flash-message {% if category == 'success' %}flash-success{% else %}flash-error{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endwith %}

<div class="table-container">
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Location</th>
                <th>Company</th>
                <th class="actions-cell">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for contact in contacts %}
            <tr>
                <td>{{ contact.name }}</td>
                <td>{{ contact.email }}</td>
                <td>{{ contact.location if contact.location else 'N/A' }}</td>
                <td>{{ contact.company_name if contact.company_name else 'N/A' }}</td>
                <td class="actions-cell">
                    <form action="{{ url_for('contact.delete_contact', list_id=list_id, contact_id=contact.id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this contact?');">
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-trash-alt"></i> Delete
                        </button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" class="empty-row">This list has no contacts yet.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}